<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Presión arterial — Adolescentes 10–17</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Quicksand', sans-serif; margin: 0; background-color: #e0f7fa; font-size: 18px; color: #333; }
    header { background-color: #0288d1; color: white; padding: 20px; text-align: center; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    h1 { margin: 0; font-size: 28px; }
    main { max-width: 600px; background: white; margin: 30px auto; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 15px; font-weight: 600; }
    input, select { padding: 10px; width: 100%; font-size: 18px; border-radius: 8px; border: 1px solid #ccc; margin-top: 5px; box-sizing: border-box; }
    button { background-color: #0288d1; color: white; cursor: pointer; margin-top: 20px; padding: 12px; width: 100%; font-size: 18px; border-radius: 8px; border: none; font-weight: 600; }
    button:hover { background-color: #0277bd; }
    .result { margin-top: 30px; font-weight: bold; font-size: 22px; text-align: center; }
    .ok { color: green; }
    .bad { color: red; }
    .info { text-align: center; margin-top: 10px; font-size: 16px; color: #555; }
  </style>
</head>
<body>
  <header>
    <h1>Clasificador de Presión Arterial (10–17 años)</h1>
  </header>
  <main>
    <form id="form">
      <label>Edad:
        <select id="edad"></select>
      </label>
      <label>Sexo:
        <select id="sexo">
          <option value="">—</option>
          <option value="F">Mujer</option>
          <option value="M">Hombre</option>
        </select>
      </label>
      <label>Talla (cm):
        <input type="number" id="talla" min="100" max="200" />
      </label>
      <label>PA Sistólica (mmHg):
        <input type="number" id="sis" />
      </label>
      <label>PA Diastólica (mmHg):
        <input type="number" id="dia" />
      </label>
      <button type="button" id="analizar">Analizar</button>
    </form>
    <div class="result" id="resultado"></div>
    <div class="info" id="umbral"></div>
    <div class="info" id="tallaUsada"></div>
  </main>

<script>
// Datos de referencia P90 según sexo, edad y talla (percentiles)
const datos = {
  F: {
    10:{ tallas:[129.7,132.2,136.3,141,145.8,150.2,152.8], sys:[109,110,111,112,113,115,113], dia:[72,73,73,73,73,73,73] },
    11:{ tallas:[135.6,138.3,142.8,147.8,152.8,157.3,160], sys:[111,112,113,114,116,118,120], dia:[74,74,74,74,74,75,75] },
    12:{ tallas:[148.1,150.6,154.7,159.2,163.7,167.8,170.2], sys:[114,115,116,118,120,122,122], dia:[75,75,75,75,76,76,76] },
    13:{ tallas:[150.6,153,156.9,161.3,165.7,169.7,172.1], sys:[116,117,119,121,122,123,123], dia:[75,75,75,76,76,76,76] },
    14:{ tallas:[151.7,154,157.9,162.3,166.7,170.6,173], sys:[118,118,120,122,123,123,123], dia:[76,76,76,76,77,77,77] },
    15:{ tallas:[152.1,154.5,158.4,162.8,167.1,171.1,173.4], sys:[118,119,121,122,123,123,124], dia:[76,76,76,77,77,78,78] },
    16:{ tallas:[152.4,154.7,158.7,163,167.4,171.3,173.7], sys:[119,120,122,123,124,124,124], dia:[76,76,76,77,78,78,78] },
    17:{ tallas:[152.4,154.7,158.7,163,167.4,171.3,173.7], sys:[120,121,123,124,124,125,125], dia:[76,76,77,77,78,78,78] }
  },
  M: {
    10:{ tallas:[130.2,132.7,136.7,141.3,145.9,150.1,152.7], sys:[108,109,111,112,113,115,116], dia:[72,73,74,74,75,75,76] },
    11:{ tallas:[134.7,137.3,141.5,146.4,151.3,155.8,158.6], sys:[110,111,112,114,116,117,118], dia:[74,74,75,75,75,76,76] },
    12:{ tallas:[147,150,154.9,160.3,165.7,170.5,173.4], sys:[113,114,115,117,119,121,122], dia:[75,75,75,75,75,76,76] },
    13:{ tallas:[153.8,156.9,162,167.5,172.7,177.4,180.1], sys:[115,116,118,121,124,126,126], dia:[74,74,74,75,76,77,77] },
    14:{ tallas:[159,162,166.9,172.2,177.2,181.6,184.2], sys:[119,120,123,126,127,128,129], dia:[74,74,75,77,78,79,80] },
    15:{ tallas:[162.1,165,169.6,174.6,179.5,183.8,186.4], sys:[123,124,126,128,129,130,130], dia:[75,76,78,79,80,81,81] },
    16:{ tallas:[163.8,166.5,170.9,175.8,180.7,184.9,187.5], sys:[126,127,128,129,131,131,132], dia:[77,78,79,80,81,82,82] },
    17:{ tallas:[163.8,166.5,170.9,175.8,180.7,184.9,187.5], sys:[128,129,130,131,132,133,134], dia:[78,79,80,81,82,82,83] }
  }
};

// llenar opciones de edad
const edadSel = document.getElementById('edad');
for (let i = 10; i <= 17; i++) {
  let opt = document.createElement('option');
  opt.value = i;
  opt.textContent = i;
  edadSel.appendChild(opt);
}

document.getElementById('analizar').addEventListener('click', evaluar);

function evaluar() {
  const edad = parseInt(edadSel.value);
  const sexo = document.getElementById('sexo').value;
  const tallaVal = parseFloat(document.getElementById('talla').value);
  const sisVal = parseInt(document.getElementById('sis').value);
  const diaVal = parseInt(document.getElementById('dia').value);

  if (!edad || !sexo || isNaN(tallaVal) || isNaN(sisVal) || isNaN(diaVal)) {
    document.getElementById('resultado').textContent = '⚠️ Complete todos los campos.';
    document.getElementById('resultado').className = 'result';
    document.getElementById('umbral').textContent = '';
    document.getElementById('tallaUsada').textContent = '';
    return;
  }

  const ref = datos[sexo][edad];
  if (!ref) {
    document.getElementById('resultado').textContent = 'No hay datos disponibles para esa edad o sexo.';
    document.getElementById('resultado').className = 'result';
    return;
  }

  // ======= selección: mayor talla <= tallaVal dentro de LA MISMA edad =======
  let idx = 0;
  const tallas = ref.tallas;
  // si la talla ingresada es menor que la menor de la tabla -> usar la menor (índice 0)
  if (tallaVal <= tallas[0]) {
    idx = 0;
  } else {
    // buscar la mayor talla que sea <= tallaVal
    idx = 0;
    for (let i = 0; i < tallas.length; i++) {
      if (tallaVal >= tallas[i]) {
        idx = i; // actualiza hasta la última que cumpla
      } else {
        break; // las tallas están ordenadas: si falla, las siguientes serán mayores
      }
    }
  }

  const sys90 = ref.sys[idx];
  const dia90 = ref.dia[idx];

  const sexoTxt = sexo === 'F' ? 'Mujer' : 'Hombre';
  document.getElementById('umbral').textContent =
    `Referencia (P90) — ${sexoTxt}, ${edad} años: Sistólica ≥ ${sys90} mmHg, Diastólica ≥ ${dia90} mmHg`;
  document.getElementById('tallaUsada').textContent =
    `Talla de referencia usada: ${tallas[idx]} cm`;

  if (sisVal >= sys90 || diaVal >= dia90) {
    document.getElementById('resultado').innerHTML = `<span class='bad'>ANORMAL — posible hipertensión</span>`;
    document.getElementById('resultado').className = 'result bad';
  } else {
    document.getElementById('resultado').innerHTML = `<span class='ok'>NORMAL</span>`;
    document.getElementById('resultado').className = 'result ok';
  }
}
</script>
</body>
</html>
